# problem 309. Best Time to Buy and Sell Stock with Cooldown

[题目链接](https://leetcode.com/problems/best-time-to-buy-and-sell-stock-with-cooldown/)

## 方法

可以对标 本类型的第二题（没有交易限制的最大利润）。

当时直接是把正的delta加了起来，在那道题的情况下非常简单，然而切换到这道题时就有点不好入手了。

其实，如果把这类题都建模为自动机，根据具体条件设置每个状态的转移，那么就可以得到一个相对通用的解法。

以这道题为例，根据题设要求，建立以下状态机：

    
    买(可维持) ---->  卖（可维持）

         \            /
          \          /
         cooldown（可维持）


在每天，需要同步更新每个状态——即当天的值只能使用前一天的相应值来更新。解释一下上面的转移：

到买的状态，要么保持，要么从上一个cooldown转移过来；

到卖的状态，要么保持，要么从上一个买的状态转移过来；

到cooldown的状态，要么保持，要么从上一个卖的状态转移过来；

选择保持或者接受转移，是根据二者带来的收益决定的——取收益更大的选择。

状态的值都表示当前最大剩余的钱。

再看初始时的状态： 由于买的状态必须要求手头有股票，所以初始化买状态时必须买入，为 - prices[0] , 其余两个状态均为0；

转移过程从下标为1开始，按照上述状态机转就好了。

## 代码